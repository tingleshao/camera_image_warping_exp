% this is a playpen stuff for the makeSaccadeConfig3.py 

% we want to know, how to compute the roll-pitch-yaw from the center 

%%%
%{
Camera #1:
K:
[3274.371753498689, 0, 493.012199518308;
 0, 3449.325958845297, 264.947660436863;
 0, 0, 1]
R:
[0.83260232, -0.019762889, 0.55351853;
 -0.048825666, 0.99285376, 0.10889252;
 -0.5517149, -0.11769008, 0.82568741]
Camera #2:
K:
[3283.009090594701, 0, 505.6283771334478;
 0, 3450.653623474587, 415.5021870011893;
 0, 0, 1]
R:
[0.92903668, -0.029306898, 0.36882505;
 -0.032080103, 0.98672312, 0.15921205;
 -0.36859417, -0.15974575, 0.91576177]
Camera #3:
K:
[3346.01932487007, 0, 841.7744281935452;
 0, 3477.594863446861, 392.8648914366403;
 0, 0, 1]
R:
[0.96557373, -0.024759892, 0.25894856;
 -0.017936984, 0.98675323, 0.16123429;
 -0.2595104, -0.16032833, 0.95233876]
Camera #4:
K:
[3504.873245293055, 0, 857.0268061574113;
 0, 3552.761934978605, 400.0926291003752;
 0, 0, 1]
R:
[0.99778223, -0.021020213, 0.063157544;
 0.010562188, 0.9868055, 0.16156578;
 -0.06572035, -0.16054037, 0.98483884]
Camera #5:
K:
[3663.925196567586, 0, 829.3804630946103;
 0, 3639.550902076714, 382.5550249045929;
 0, 0, 1]
R:
[0.990569, -0.012156032, -0.13647452;
 0.033163838, 0.98771065, 0.15273494;
 0.13294066, -0.1558205, 0.97879857]
Camera #6:
K:
[3640.948065874733, 0, -6.075880282095882;
 0, 3639.466819509074, 176.5706663982676;
 0, 0, 1]
R:
[0.85118854, -0.024983734, -0.52426523;
 0.072742119, 0.99484217, 0.07069394;
 0.51979494, -0.098310016, 0.84861553]
Camera #7:
K:
[3274.520899363306, 0, 487.798618589976;
 0, 3486.773825562255, 394.6234347062924;
 0, 0, 1]
R:
[0.82959461, -0.012268368, 0.55823147;
 0.018553618, 0.99981219, -0.0055996776;
 -0.55805784, 0.015002683, 0.82966632]
Camera #8:
K:
[3343.986517963801, 0, 705.8463145254321;
 0, 3512.812049679732, 373.9167309040359;
 0, 0, 1]
R:
[0.90472007, -0.0045238826, 0.42598262;
 0.0095945746, 0.99990636, -0.0097584948;
 -0.42589855, 0.012915812, 0.9046787]
Camera #9:
K:
[3429.439771223235, 0, 522.1145904429487;
 0, 3531.141621900665, 417.4370272278605;
 0, 0, 1]
R:
[0.9831351, 0.0033284652, 0.18285036;
 -0.0041537229, 0.99998283, 0.0041304976;
 -0.18283346, -0.0048203394, 0.983132]
Camera #10:
K:
[3500.204425418042, 0, 569.6392020109541;
 0, 3546.866404001399, 406.6612491400594;
 0, 0, 1]
R:
[1, 0, 0;
 0, 1, 0;
 -3.7252903e-09, -7.4505806e-09, 1]
Camera #11:
K:
[3564.145896083547, 0, 1038.28045923203;
 0, 3563.304938424523, 520.5899754612145;
 0, 0, 1]
R:
[0.99699479, 0.015674507, -0.075866528;
 -0.013414725, 0.99945372, 0.030204833;
 0.076298535, -0.029096328, 0.99666035]
Camera #12:
K:
[3758.919091255191, 0, 353.6801964802179;
 0, 3649.288076184293, 200.2885730663949;
 0, 0, 1]
R:
[0.90141404, -0.016634034, -0.4326385;
 -0.0064534135, 0.99863452, -0.051841255;
 0.43291003, 0.049522433, 0.90007573]
Camera #13:
K:
[3255.126294350611, 0, 360.8853331959938;
 0, 3475.825222895441, 351.2171271108331;
 0, 0, 1]
R:
[0.85197103, 0.023094729, 0.52307934;
 0.085206807, 0.97959393, -0.18203202;
 -0.51660925, 0.19965589, 0.83261776]
Camera #14:
K:
[3261.084904837336, 0, 680.6057253459197;
 0, 3475.053305321173, 395.8135790501386;
 0, 0, 1]
R:
[0.90888113, 0.016582839, 0.41672558;
 0.06201997, 0.98272485, -0.17437172;
 -0.41241807, 0.18432847, 0.89215147]
Camera #15:
K:
[3357.509016762102, 0, 951.1317044686832;
 0, 3528.361209881413, 397.4525602979513;
 0, 0, 1]
R:
[0.95546591, 0.021878285, 0.29428938;
 0.032101344, 0.98362446, -0.17734841;
 -0.29335028, 0.17889744, 0.93911725]
Camera #16:
K:
[3565.952343318186, 0, 977.3515911419896;
 0, 3634.117923553946, 471.5713785605321;
 0, 0, 1]
R:
[0.994277, 0.015645683, 0.10568103;
 0.0015788106, 0.98695815, -0.16096935;
 -0.10682122, 0.16021498, 0.98128504]
Camera #17:
K:
[3705.317184897976, 0, 170.96302729602;
 0, 3693.689792068587, 424.9599153319062;
 0, 0, 1]
R:
[0.95066601, 0.026604984, -0.30907333;
 -0.07751327, 0.98508447, -0.153624;
 0.30037615, 0.17000239, 0.93854851]
Camera #18:
K:
[3687.654771125811, 0, 716.6950972194147;
 0, 3683.261120479816, 557.7551218087481;
 0, 0, 1]
R:
[0.93535024, 0.0467427, -0.3506209;
 -0.091772631, 0.9893561, -0.1129265;
 0.34161037, 0.13780323, 0.92968416]
Warping images (auxiliary)...
Camera R before warp: 1
R:
[0.89035654, -0.0046485513, 0.45524022;
 -0.064370573, 0.9886167, 0.13599062;
 -0.45069021, -0.15038422, 0.87992215]
Camera R before warp: 2
R:
[0.96515775, -0.0093110036, 0.26150295;
 -0.041667864, 0.9811461, 0.18872266;
 -0.25832975, -0.19304337, 0.94657278]
Camera R before warp: 3
R:
[0.98895258, -0.0047271401, 0.14815718;
 -0.024022933, 0.98116755, 0.19165905;
 -0.14627296, -0.19310084, 0.97021455]
Camera R before warp: 4
R:
[0.99874532, -0.00098776817, -0.050069585;
 0.010625625, 0.98122114, 0.19259343;
 0.048939109, -0.19288379, 0.98000038]
Camera R before warp: 5
R:
[0.96880907, 0.0072773611, -0.24770157;
 0.03944841, 0.98229319, 0.18314974;
 0.24464841, -0.18720856, 0.95136744]
Camera R before warp: 6
R:
[0.78600192, -0.012056563, -0.6181066;
 0.090875104, 0.99120247, 0.096225314;
 0.61150867, -0.13180377, 0.7801826]
Camera R before warp: 7
R:
[0.88819683, -0.012425024, 0.45929536;
 0.0027693044, 0.99976087, 0.021690546;
 -0.45945489, -0.01799354, 0.88801873]
Camera R before warp: 8
R:
[0.94764173, -0.0044920482, 0.31930399;
 -0.0018681418, 0.99980599, 0.01960985;
 -0.31933004, -0.019179637, 0.94744945]
Camera R before warp: 9
R:
[0.99761659, 0.0053444286, 0.068794109;
 -0.0077974796, 0.99934143, 0.035438884;
 -0.068559378, -0.035890833, 0.99700117]
Camera R before warp: 10
R:
[0.99338871, 0.0014846695, -0.11478979;
 0.0021403094, 0.99950302, 0.031449575;
 0.11477944, -0.031487346, 0.99289185]
Camera R before warp: 11
R:
[0.98162514, 0.020394698, -0.18972655;
 -0.0088746231, 0.99807554, 0.06137199;
 0.19061309, -0.058560535, 0.97991693]
Camera R before warp: 12
R:
[0.84575129, -0.02072609, -0.53317469;
 0.0090939347, 0.99966007, -0.024434472;
 0.53349984, 0.01581683, 0.84565216]
Camera R before warp: 13
R:
[0.90576637, 0.0014779568, 0.42377487;
 0.070740804, 0.98543561, -0.15463653;
 -0.4178313, 0.17004269, 0.89246982]
Camera R before warp: 14
R:
[0.95030576, -0.0032267999, 0.31130171;
 0.050964065, 0.98806894, -0.14533535;
 -0.30711851, 0.15397821, 0.93913192]
Camera R before warp: 15
R:
[0.9828704, 0.0026583988, 0.18427935;
 0.024904642, 0.98880875, -0.14709556;
 -0.18260804, 0.14916527, 0.9718045]
Camera R before warp: 16
R:
[0.99996787, -0.0013834927, -0.0078981444;
 0.0003466045, 0.99153984, -0.12980217;
 0.0080109239, 0.12979525, 0.99150842]
Camera R before warp: 17
R:
[0.90978569, 0.0083770771, -0.41499382;
 -0.065993331, 0.98999828, -0.1246922;
 0.40979862, 0.14083, 0.9012391]
Camera R before warp: 18
R:
[0.88981676, 0.032084137, -0.45518875;
 -0.078981578, 0.99329829, -0.084382638;
 0.44943082, 0.11103661, 0.88638753]
Warping images, time: 0.748182 sec
Compositing...
Compositing image #1
Camera R before warp2: 1
R:
[0.89035654, -0.0046485513, 0.45524022;
 -0.064370573, 0.9886167, 0.13599062;
 -0.45069021, -0.15038422, 0.87992215]
Multi-band blender, number of bands: 7
Compositing image #2
Camera R before warp2: 2
R:
[0.96515775, -0.0093110036, 0.26150295;
 -0.041667864, 0.9811461, 0.18872266;
 -0.25832975, -0.19304337, 0.94657278]
Compositing image #3
Camera R before warp2: 3
R:
[0.98895258, -0.0047271401, 0.14815718;
 -0.024022933, 0.98116755, 0.19165905;
 -0.14627296, -0.19310084, 0.97021455]
Compositing image #4
Camera R before warp2: 4
R:
[0.99874532, -0.00098776817, -0.050069585;
 0.010625625, 0.98122114, 0.19259343;
 0.048939109, -0.19288379, 0.98000038]
Compositing image #5
Camera R before warp2: 5
R:
[0.96880907, 0.0072773611, -0.24770157;
 0.03944841, 0.98229319, 0.18314974;
 0.24464841, -0.18720856, 0.95136744]
Compositing image #6
Camera R before warp2: 6
R:
[0.78600192, -0.012056563, -0.6181066;
 0.090875104, 0.99120247, 0.096225314;
 0.61150867, -0.13180377, 0.7801826]
Compositing image #7
Camera R before warp2: 7
R:
[0.88819683, -0.012425024, 0.45929536;
 0.0027693044, 0.99976087, 0.021690546;
 -0.45945489, -0.01799354, 0.88801873]
Compositing image #8
Camera R before warp2: 8
R:
[0.94764173, -0.0044920482, 0.31930399;
 -0.0018681418, 0.99980599, 0.01960985;
 -0.31933004, -0.019179637, 0.94744945]
Compositing image #9
Camera R before warp2: 9
R:
[0.99761659, 0.0053444286, 0.068794109;
 -0.0077974796, 0.99934143, 0.035438884;
 -0.068559378, -0.035890833, 0.99700117]
Compositing image #10
Camera R before warp2: 10
R:
[0.99338871, 0.0014846695, -0.11478979;
 0.0021403094, 0.99950302, 0.031449575;
 0.11477944, -0.031487346, 0.99289185]
Compositing image #11
Camera R before warp2: 11
R:
[0.98162514, 0.020394698, -0.18972655;
 -0.0088746231, 0.99807554, 0.06137199;
 0.19061309, -0.058560535, 0.97991693]
Compositing image #12
Camera R before warp2: 12
R:
[0.84575129, -0.02072609, -0.53317469;
 0.0090939347, 0.99966007, -0.024434472;
 0.53349984, 0.01581683, 0.84565216]
Compositing image #13
Camera R before warp2: 13
R:
[0.90576637, 0.0014779568, 0.42377487;
 0.070740804, 0.98543561, -0.15463653;
 -0.4178313, 0.17004269, 0.89246982]
Compositing image #14
Camera R before warp2: 14
R:
[0.95030576, -0.0032267999, 0.31130171;
 0.050964065, 0.98806894, -0.14533535;
 -0.30711851, 0.15397821, 0.93913192]
Compositing image #15
Camera R before warp2: 15
R:
[0.9828704, 0.0026583988, 0.18427935;
 0.024904642, 0.98880875, -0.14709556;
 -0.18260804, 0.14916527, 0.9718045]
Compositing image #16
Camera R before warp2: 16
R:
[0.99996787, -0.0013834927, -0.0078981444;
 0.0003466045, 0.99153984, -0.12980217;
 0.0080109239, 0.12979525, 0.99150842]
Compositing image #17
Camera R before warp2: 17
R:
[0.90978569, 0.0083770771, -0.41499382;
 -0.065993331, 0.98999828, -0.1246922;
 0.40979862, 0.14083, 0.9012391]
Compositing image #18
Camera R before warp2: 18
R:
[0.88981676, 0.032084137, -0.45518875;
 -0.078981578, 0.99329829, -0.084382638;
 0.44943082, 0.11103661, 0.88638753]
Compositing, time: 10.4576 sec
last place: 1
R:
[0.89035654, -0.0046485513, 0.45524022;
 -0.064370573, 0.9886167, 0.13599062;
 -0.45069021, -0.15038422, 0.87992215]
last place: 2
R:
[0.96515775, -0.0093110036, 0.26150295;
 -0.041667864, 0.9811461, 0.18872266;
 -0.25832975, -0.19304337, 0.94657278]
last place: 3
R:
[0.98895258, -0.0047271401, 0.14815718;
 -0.024022933, 0.98116755, 0.19165905;
 -0.14627296, -0.19310084, 0.97021455]
last place: 4
R:
[0.99874532, -0.00098776817, -0.050069585;
 0.010625625, 0.98122114, 0.19259343;
 0.048939109, -0.19288379, 0.98000038]
last place: 5
R:
[0.96880907, 0.0072773611, -0.24770157;
 0.03944841, 0.98229319, 0.18314974;
 0.24464841, -0.18720856, 0.95136744]
last place: 6
R:
[0.78600192, -0.012056563, -0.6181066;
 0.090875104, 0.99120247, 0.096225314;
 0.61150867, -0.13180377, 0.7801826]
last place: 7
R:
[0.88819683, -0.012425024, 0.45929536;
 0.0027693044, 0.99976087, 0.021690546;
 -0.45945489, -0.01799354, 0.88801873]
last place: 8
R:
[0.94764173, -0.0044920482, 0.31930399;
 -0.0018681418, 0.99980599, 0.01960985;
 -0.31933004, -0.019179637, 0.94744945]
last place: 9
R:
[0.99761659, 0.0053444286, 0.068794109;
 -0.0077974796, 0.99934143, 0.035438884;
 -0.068559378, -0.035890833, 0.99700117]
last place: 10
R:
[0.99338871, 0.0014846695, -0.11478979;
 0.0021403094, 0.99950302, 0.031449575;
 0.11477944, -0.031487346, 0.99289185]
last place: 11
R:
[0.98162514, 0.020394698, -0.18972655;
 -0.0088746231, 0.99807554, 0.06137199;
 0.19061309, -0.058560535, 0.97991693]
last place: 12
R:
[0.84575129, -0.02072609, -0.53317469;
 0.0090939347, 0.99966007, -0.024434472;
 0.53349984, 0.01581683, 0.84565216]
last place: 13
R:
[0.90576637, 0.0014779568, 0.42377487;
 0.070740804, 0.98543561, -0.15463653;
 -0.4178313, 0.17004269, 0.89246982]
last place: 14
R:
[0.95030576, -0.0032267999, 0.31130171;
 0.050964065, 0.98806894, -0.14533535;
 -0.30711851, 0.15397821, 0.93913192]
last place: 15
R:
[0.9828704, 0.0026583988, 0.18427935;
 0.024904642, 0.98880875, -0.14709556;
 -0.18260804, 0.14916527, 0.9718045]
last place: 16
R:
[0.99996787, -0.0013834927, -0.0078981444;
 0.0003466045, 0.99153984, -0.12980217;
 0.0080109239, 0.12979525, 0.99150842]
last place: 17
R:
[0.90978569, 0.0083770771, -0.41499382;
 -0.065993331, 0.98999828, -0.1246922;
 0.40979862, 0.14083, 0.9012391]
last place: 18
R:
[0.88981676, 0.032084137, -0.45518875;
 -0.078981578, 0.99329829, -0.084382638;
 0.44943082, 0.11103661, 0.88638753]
%}

K1 = [3274.371753498689, 0, 493.012199518308;
 0, 3449.325958845297, 264.947660436863;
 0, 0, 1];
R1 = [0.83260232, -0.019762889, 0.55351853;
 -0.048825666, 0.99285376, 0.10889252;
 -0.5517149, -0.11769008, 0.82568741];
K2 = [3283.009090594701, 0, 505.6283771334478;
 0, 3450.653623474587, 415.5021870011893;
 0, 0, 1];
R2 = [0.92903668, -0.029306898, 0.36882505;
 -0.032080103, 0.98672312, 0.15921205;
 -0.36859417, -0.15974575, 0.91576177];
K3 = [3346.01932487007, 0, 841.7744281935452;
 0, 3477.594863446861, 392.8648914366403;
 0, 0, 1];
R3 = [0.96557373, -0.024759892, 0.25894856;
 -0.017936984, 0.98675323, 0.16123429;
 -0.2595104, -0.16032833, 0.95233876];
K4 = [3504.873245293055, 0, 857.0268061574113;
 0, 3552.761934978605, 400.0926291003752;
 0, 0, 1];
R4 = [0.99778223, -0.021020213, 0.063157544;
 0.010562188, 0.9868055, 0.16156578;
 -0.06572035, -0.16054037, 0.98483884];
K5 = [3663.925196567586, 0, 829.3804630946103;
 0, 3639.550902076714, 382.5550249045929;
 0, 0, 1];
R5 = [0.990569, -0.012156032, -0.13647452;
 0.033163838, 0.98771065, 0.15273494;
 0.13294066, -0.1558205, 0.97879857];
K6 = [3640.948065874733, 0, -6.075880282095882;
 0, 3639.466819509074, 176.5706663982676;
 0, 0, 1];
R6 = [0.85118854, -0.024983734, -0.52426523;
 0.072742119, 0.99484217, 0.07069394;
 0.51979494, -0.098310016, 0.84861553];
K7 = [3274.520899363306, 0, 487.798618589976;
 0, 3486.773825562255, 394.6234347062924;
 0, 0, 1];
R7 = [0.82959461, -0.012268368, 0.55823147;
 0.018553618, 0.99981219, -0.0055996776;
 -0.55805784, 0.015002683, 0.82966632];
K8 = [3343.986517963801, 0, 705.8463145254321;
 0, 3512.812049679732, 373.9167309040359;
 0, 0, 1];
R8 = [0.90472007, -0.0045238826, 0.42598262;
 0.0095945746, 0.99990636, -0.0097584948;
 -0.42589855, 0.012915812, 0.9046787];
K9 = [3429.439771223235, 0, 522.1145904429487;
 0, 3531.141621900665, 417.4370272278605;
 0, 0, 1];
R9 = [0.9831351, 0.0033284652, 0.18285036;
 -0.0041537229, 0.99998283, 0.0041304976;
 -0.18283346, -0.0048203394, 0.983132];
K10 = [3500.204425418042, 0, 569.6392020109541;
 0, 3546.866404001399, 406.6612491400594;
 0, 0, 1];
R10 = [1, 0, 0;
 0, 1, 0;
 -3.7252903e-09, -7.4505806e-09, 1];
K11 = [3564.145896083547, 0, 1038.28045923203;
 0, 3563.304938424523, 520.5899754612145;
 0, 0, 1];
R11 = [0.99699479, 0.015674507, -0.075866528;
 -0.013414725, 0.99945372, 0.030204833;
 0.076298535, -0.029096328, 0.99666035];
K12 = [3758.919091255191, 0, 353.6801964802179;
 0, 3649.288076184293, 200.2885730663949;
 0, 0, 1];
R12 = [0.90141404, -0.016634034, -0.4326385;
 -0.0064534135, 0.99863452, -0.051841255;
 0.43291003, 0.049522433, 0.90007573];
K13 = [3255.126294350611, 0, 360.8853331959938;
 0, 3475.825222895441, 351.2171271108331;
 0, 0, 1];
R13 = [0.85197103, 0.023094729, 0.52307934;
 0.085206807, 0.97959393, -0.18203202;
 -0.51660925, 0.19965589, 0.83261776];
K14 = [3261.084904837336, 0, 680.6057253459197;
 0, 3475.053305321173, 395.8135790501386;
 0, 0, 1];
R14 = [0.90888113, 0.016582839, 0.41672558;
 0.06201997, 0.98272485, -0.17437172;
 -0.41241807, 0.18432847, 0.89215147];
K15 = [3357.509016762102, 0, 951.1317044686832;
 0, 3528.361209881413, 397.4525602979513;
 0, 0, 1];
R15 = [95546591, 0.021878285, 0.29428938;
 0.032101344, 0.98362446, -0.17734841;
 -0.29335028, 0.17889744, 0.93911725];
K16 = [3565.952343318186, 0, 977.3515911419896;
 0, 3634.117923553946, 471.5713785605321;
 0, 0, 1];
R16 = [0.994277, 0.015645683, 0.10568103;
 0.0015788106, 0.98695815, -0.16096935;
 -0.10682122, 0.16021498, 0.98128504];
K17 = [3705.317184897976, 0, 170.96302729602;
 0, 3693.689792068587, 424.9599153319062;
 0, 0, 1];
R17 = [0.95066601, 0.026604984, -0.30907333;
 -0.07751327, 0.98508447, -0.153624;
 0.30037615, 0.17000239, 0.93854851];
K18 = [3687.654771125811, 0, 716.6950972194147;
 0, 3683.261120479816, 557.7551218087481;
 0, 0, 1];
R18 = [0.93535024, 0.0467427, -0.3506209;
 -0.091772631, 0.9893561, -0.1129265;
 0.34161037, 0.13780323, 0.92968416];

% construct H matrix: H = KRK^(-1), (true?)
% and try warping all images, see how the result look like 

% Synthesize images, with colors
for i = 1:18
   eval(sprintf('img%d = imresize(imread(''mcam_%d_scale_2.jpg''),[920,1228]);',i,i));
end

% Warp the images
% Then show the result
for i = 1:18
    eval(sprintf('H%d = K%d * R%d * (K%d)^(-1);',i,i,i,i));
end

% compute the euler angels between 10 and 11, 10 and 9
eul8 = rotm2eul(R8)
eul9 = rotm2eul(R9)
eul10 = rotm2eul(R10)
eul11 = rotm2eul(R11)

xMin = 0
xMax = 1000

yMin = 0
yMax = 1000

% Width and height of panorama.
% width  = round(xMax - xMin);
% height = round(yMax - yMin);
% xLimits = [xMin xMax];
% yLimits = [yMin yMax];
% panoramaView = imref2d([height width], xLimits, yLimits);
% 
% for i = 1:14
%   %  eval(sprintf('T = projective2d(transpose(H%d));',i));
%       eval(sprintf('T = projective2d(H%d'');',i));
% 
%   %  eval(sprintf('I = imwarp(''perspective'',H%d)',i));
% %warpedImage = imwarp(img1, T, 'OutputView', panoramaView);\
%     eval(sprintf('[I%d, RB%d]=imwarp(img%d,T);',i,i,i));
%     %figure;
%     subplot(3,6,i);
%     eval(sprintf('imshow(I%d)',i));
%     eval(sprintf('X = RB%i.XWorldLimits; Y = RB%i.YWorldLimits',i,i));
%     title([num2str(Y(1))]);
% end
% 
% [I12,RB12] = imfuse(I1,RB1,I2,RB2, 'blend');
% list = [1,12,123,1234,12345,123456,12345678,123456789,12345678910,1234567891011,1234567891012,1234567891013,1234567891014,1234567891015];
% for i = 2:14
%     eval(sprintf('[I%d,RB%d] = imfuse(I%d,RB%d,I%d,RB%d,''blend'');',list(i+1),list(i+1),i,i,list(i),list(i)));
% end
% 
